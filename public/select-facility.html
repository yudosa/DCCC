<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>이용시설 선택 - 흥덕청소년 문화의집</title>
    <link rel="stylesheet" href="styles.css">
    <script type="module" src="firebase-config.js"></script>
</head>
<body>
    <div class="container vertical-layout">
        <!-- 상단 배너 섹션 -->
        <div class="banner-section">
            <div class="current-datetime"></div>
            <div class="banner-image">
                <div class="image-slider">
                    <img src="dc1.jpg" alt="동천청소년 문화의집 건물" class="main-building-img active">
                    <img src="dc2.jpg" alt="동천청소년 문화의집 건물" class="main-building-img">
                    <img src="dc3.jpg" alt="동천청소년 문화의집 건물" class="main-building-img">
                    <img src="dc4.jpg" alt="동천청소년 문화의집 건물" class="main-building-img">
                    <img src="dc5.jpg" alt="동천청소년 문화의집 건물" class="main-building-img">
                    <img src="dc6.jpg" alt="동천청소년 문화의집 건물" class="main-building-img">
                    <img src="dc7.jpg" alt="동천청소년 문화의집 건물" class="main-building-img">
                    <img src="dc8.jpg" alt="동천청소년 문화의집 건물" class="main-building-img">
                </div>
                </div>
                <div class="slider-dots">
                    <span class="dot active"></span>
                    <span class="dot"></span>
                    <span class="dot"></span>
                    <span class="dot"></span>
                    <span class="dot"></span>
                    <span class="dot"></span>
                    <span class="dot"></span>
                    <span class="dot"></span>
                </div>
            </div>
        </div>
        
        <main class="rental-main">
            <div class="facility-selection-header">
                <h2>이용한 공간을 선택하세요</h2>
            </div>
            
            <!-- 3층 -->
            <div class="floor-section">
                <div class="floor-label">3층</div>
                <div class="facility-group">
                    <div class="facility-cards-row">
                        <div class="facility-card" onclick="window.location.href='reservation-date.html'">
                            <div class="facility-emoji">💃</div>
                            <div class="facility-name">댄스연습실</div>
                        </div>
                        <div class="facility-card" onclick="window.location.href='reservation-date.html'">
                            <div class="facility-emoji">🏢</div>
                            <div class="facility-name">소회의실</div>
                        </div>
                    </div>
                    <div class="autonomous-section">
                        <div class="autonomous-label">자율이용</div>
                        <div class="facility-cards-row autonomous-row">
                            <div class="facility-card autonomous-card" id="autonomousCard">
                                <div class="facility-emoji">📚</div>
                                <div class="facility-name">자율이용<br>(예약 불필요)</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 2층 -->
            <div class="floor-section">
                <div class="floor-label">2층</div>
                <div class="facility-group">
                    <div class="facility-cards-row">
                        <div class="facility-card" onclick="window.location.href='reservation-date.html'">
                            <div class="facility-emoji">🎮</div>
                            <div class="facility-name">닌텐도</div>
                        </div>
                        <div class="facility-card" onclick="window.location.href='reservation-date.html'">
                            <div class="facility-emoji">🎯</div>
                            <div class="facility-name">PS5</div>
                        </div>
                    </div>
                    <div class="facility-cards-row">
                        <div class="facility-card" onclick="window.location.href='reservation-date.html'">
                            <div class="facility-emoji">🎤</div>
                            <div class="facility-name">노래방</div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="form-actions-centered">
                <button class="btn-secondary-centered facility-back-btn" onclick="window.location.href='index.html'">◀ 이전</button>
                <button class="btn-secondary-centered facility-home-btn" onclick="sessionStorage.removeItem('agreedPersonalInfo'); window.location.href='index.html'">↻ 처음으로</button>
            </div>
        </main>
    </div>

    <script>
    // 시설 카드 클릭 시 시설명 저장 (자율이용 제외)
    document.querySelectorAll('.facility-card:not(#autonomousCard)').forEach(card => {
        card.addEventListener('click', function() {
            let name = card.querySelector('.facility-name').textContent.trim();
            sessionStorage.setItem('selectedFacility', name);
            window.location.href = 'reservation-date.html';
        });
    });

    // 자율이용 카드 클릭 이벤트는 DOMContentLoaded에서 설정

    window.showAutonomousUseModal = function() {
        console.log('자율이용 모달 함수 호출됨');
        
        // 기존 모달이 있다면 제거
        const existingModal = document.querySelector('.custom-modal-bg');
        if (existingModal) {
            existingModal.remove();
        }
        
        let modal = document.createElement('div');
        modal.className = 'custom-modal-bg';
        modal.innerHTML = `
            <div class="custom-modal" style="max-width: 500px;">
                <div class="custom-modal-header">
                    <h3>자율이용 안내</h3>
                    <button class="custom-modal-close" onclick="this.closest('.custom-modal-bg').remove()">×</button>
                </div>
                <div class="custom-modal-body">
                    <div style="text-align: center; margin-bottom: 20px;">
                        <div style="font-size: 3rem; margin-bottom: 15px;">📚</div>
                        <h4 style="color: #2c3e50; margin-bottom: 15px;">자율이용 공간</h4>
                        <p style="color: #7f8c8d; line-height: 1.6; margin-bottom: 20px;">
                            자율이용 공간은 예약 없이 자유롭게 이용할 수 있는 공간입니다.<br>
                            언제든지 방문하여 이용하실 수 있습니다.
                        </p>
                        <div style="background: #ecf0f1; padding: 15px; border-radius: 10px; margin-bottom: 20px;">
                            <h5 style="color: #2c3e50; margin-bottom: 10px;">📋 이용 안내</h5>
                            <ul style="text-align: left; color: #7f8c8d; line-height: 1.8;">
                                <li>예약 없이 자유롭게 이용 가능</li>
                                <li>이용 시간 제한 없음</li>
                                <li>다른 이용자와 함께 공유하여 사용</li>
                                <li>이용 후 정리정돈 필수</li>
                            </ul>
                        </div>
                    </div>
                </div>
                <div class="custom-modal-footer">
                    <button class="btn-primary" onclick="this.closest('.custom-modal-bg').remove()">확인</button>
                </div>
            </div>
        `;
        
        document.body.appendChild(modal);
        
        // 모달 배경 클릭 시 닫기
        modal.addEventListener('click', function(e) {
            if (e.target === modal) {
                modal.remove();
            }
        });
    };

    // DOM이 로드된 후 자율이용 카드 클릭 이벤트 설정
    document.addEventListener('DOMContentLoaded', function() {
        const autonomousCard = document.getElementById('autonomousCard');
        if (autonomousCard) {
            autonomousCard.addEventListener('click', function(e) {
                e.preventDefault();
                e.stopPropagation();
                showAutonomousUseModal();
            });
        }
    });

    // 현재 시간 표시
    function updateDateTime() {
        const now = new Date();
        const year = now.getFullYear();
        const month = String(now.getMonth() + 1).padStart(2, '0');
        const day = String(now.getDate()).padStart(2, '0');
        const hours = String(now.getHours()).padStart(2, '0');
        const minutes = String(now.getMinutes()).padStart(2, '0');
        const seconds = String(now.getSeconds()).padStart(2, '0');
        
        const weekdays = ['일', '월', '화', '수', '목', '금', '토'];
        const weekday = weekdays[now.getDay()];
        
        const dateTimeElement = document.querySelector('.current-datetime');
        if (dateTimeElement) {
            dateTimeElement.innerHTML = `
                <div class="datetime-info">
                    <span class="date">${year}-${month}-${day} (${weekday})</span>
                    <span class="time">${hours}:${minutes}:${seconds}</span>
                </div>
            `;
        }
    }

    // 페이지 로드 시 시간 표시 및 주기적 업데이트
    updateDateTime();
    setInterval(updateDateTime, 1000);

    // 이미지 슬라이더
    let currentImageIndex = 0;
    const images = document.querySelectorAll('.main-building-img');
    const dots = document.querySelectorAll('.dot');

    function showImage(index) {
        images.forEach((img, i) => {
            img.classList.toggle('active', i === index);
        });
        dots.forEach((dot, i) => {
            dot.classList.toggle('active', i === index);
        });
    }

    function nextImage() {
        currentImageIndex = (currentImageIndex + 1) % images.length;
        showImage(currentImageIndex);
    }

    // 자동 슬라이더 시작
    setInterval(nextImage, 3000);

    // 도트 클릭 이벤트
    dots.forEach((dot, index) => {
        dot.addEventListener('click', () => {
            currentImageIndex = index;
            showImage(currentImageIndex);
        });
    });
    </script>
</body>
</html>